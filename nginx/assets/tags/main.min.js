riot.tag2("administrator-user-list",'<div> <div class="row"> <div class="col-md-12"> <div class="row"> <div class="col-md-6"> <button class="btn btn-primary list-pointer" data-toggle="modal" data-target="#document_admin_Modal" onclick="{modal.modalOnCreate}"> <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 新規作成 </button> </div> <div class="col-md-6"> <form> <input type="text" placeholder="検索ワードを入力" ref="search_key"> </form> </div> </div> <br> </div> <table class="table table-hover col-md-12"> <thead> <tr class="row"> <th onclick="{_func.sortDocumentList}" id="sort_origText" ref="origText" class="list-pointer col-md-6"> 原文 <span class="{status.sortIcon[0]}" aria-hidden="true" aria-label="Right Align"></span> </th> <th onclick="{_func.sortDocumentList}" id="sort_transText" ref="transText" class="list-pointer col-md-3"> 翻訳文 <span class="{status.sortIcon[1]}" aria-hidden="true" aria-label="Right Align"></span> </th> <th onclick="{_func.sortDocumentList}" id="sort_remarks" ref="remarks" class="list-pointer col-md-3"> 備考 <span class="{status.sortIcon[2]}" aria-hidden="true" aria-label="Right Align"></span> </th> </tr> </thead> <tbody> <tr each="{item, i in status.getData()}" name="{item.publicId}" class="list-pointer row"> <th onclick="{modal.modalOn}" class="col-md-6" id="view_origText_{item.publicId}" data-toggle="modal" data-target="#document_admin_Modal"> {item.origText} </th> <th onclick="{modal.modalOn}" class="col-md-3" id="view_transText_{item.publicId}" data-toggle="modal" data-target="#document_admin_Modal"> {item.transText} </th> <th onclick="{modal.modalOn}" class="col-md-3" id="view_remarks_{item.publicId}" data-toggle="modal" data-target="#document_admin_Modal"> {item.remarks} </th> </tr> </tbody> </table> </div> <div class="modal fade" id="document_admin_Modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"> <div class="modal-dialog modal-lg" role="document"> <div class="modal-content"> <div class="modal-header"> <h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5> <button type="button" class="close list-pointer" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> </div> <div class="modal-body"> <form onsubmit="{_func.saveDocument}"> <input if="{!status.newFlag}" type="hidden" name="publicId" riot-value="{modal._document.publicId}"> <input type="hidden" name="ymlFileId" riot-value="{opts.publicid}"> <div class="row"> <div class="form-group col-md-12"> <label>Key:</label> <input required type="text" class="form-control" riot-value="{modal._document.key}" name="key"> </div> </div> <div class="row"> <div class="form-group col-md-6"> <div>原文</div> <textarea name="origText" rows="14" class="form-control">{modal._document.origText}</textarea> </div> <div class="col-md-6"> <div class="form-group col-md-12"> <div>Google翻訳</div> <textarea name="transGoogleText" rows="6" class="form-control">{modal._document.transGoogleText}</textarea> </div> <div class="form-group col-md-12"> <div>翻訳</div> <textarea name="transText" rows="6" class="form-control">{modal._document.transText}</textarea> </div> </div> </div> <div class="row"> <div class="form-group col-md-12"> <label>備考欄:</label> <input required type="text" class="form-control" riot-value="{modal._document.remarks}" name="remarks"> </div> </div> <div class="row"> <div class="form-group col-md-12"> <input type="radio" name="status" value="50" checked="{checked:modal.checkStatus()}">翻訳完了 <input type="radio" name="status" value="0" checked="{checked:!modal.checkStatus()}">未完了 </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-secondary list-pointer" data-dismiss="modal"> Close </button> <button type="submit" class="btn btn-primary list-pointer">Save changes</button> </div> </form> </div> </div> </div> </div> </div>','administrator-user-list .list-pointer,[data-is="administrator-user-list"] .list-pointer{ cursor: pointer; }',"",function(t){var a=this;this.mixin(OptsMixin),this.status={_data:[],headingName:[],sortState:[],sortIcon:[],edit:!1,newCreate:!1,publicYmlFileId:t.publicid,publicDocumentId:null,editName:null,editVersion:null,pageCount:5,pageMaxNation:5,pageMax:null,pageNumber:1,pageLabel:[],pageIdLabel:[],newFlag:!1,fileStatus:!1,getData:function(){return a.status._data},setData:function(t){a.status._data=t,a.status.pageMax=Math.ceil(t.length/a.status.pageCount)},editOn:function(t){t.preventUpdate=!0,t.preventDefault(),a.status.edit=!0;t.target.id.split("_");location.href="/game/file/document?id="+a.status.publicYmlFileId+"#document-popup-model"},editOff:function(){a.status.edit=!1},newCreateOn:function(){a.status.newCreate=!0},newCreateOff:function(){a.status.newCreate=!1},setIdName:function(t,e){a.status.publicYmlFileId=t,a.status.editName=e},pageFileCheck:function(){a.status.pageLabel=a.pageCheck(a.status.pageMax,a.status.pageNumber),console.log(a.status.pageLabel)},getPage:function(){return a.status.pageLabel},setPageIdLabel:function(){for(var t=0;t<a.status._data.length;t++)a.status.pageIdLabel[t]={label:Math.ceil((t+1)/a.status.pageCount),id:a.status._data[t].publicId};a.status.pageMax=Math.ceil(a.status._data.length/a.status.pageCount),console.log("setPage:",a.status.pageIdLabel)},pageLabelCheck:function(t){if(t==a.status.pageNumber)return!0}},this.modal={_document:null,modalOnCreate:function(){a.status.newFlag=!0,a.modal._document={key:"",origText:"",transGoogleText:"",transText:"",remarks:"",publicId:""},a.update()},modalOn:function(t){t.preventUpdate=!0,t.preventDefault(),a.status.newFlag=!1;for(var e=t.target.id.split("_"),s=0;s<a.status._data.length;s++)e[2]===a.status._data[s].publicId&&(a.modal._document=a.status._data[s]);console.log("modal_Document",a.modal._document),a.update()},modalOff:function(t){t.preventUpdate=!0,t.preventDefault()},checkStatus:function(){return 50==a.modal._document.status?(console.log(!0),!0):(console.log(!1),!1)}},this._func={init:function(){for(var t="/system/account",e={method:"GET",credentials:"include"},s=0;s<a.status.headingName.length;s++)a.status.sortIcon[s]="glyphicon glyphicon-sort";console.log("api",t),fetch(t,e).then(function(t){console.log("response:",t),t.ok?t.json().then(function(t){console.log("JSON:",t),a.status.newFlag=!0,a.status.setData(t.data),console.log("setData:",a.status),a.status.pageFileCheck(),a.status.setPageIdLabel(),a.modal.modalOnCreate(),a.status.pageLabel[a.status.pageNumber-1].pageClass="active";for(var e=0;e<a.status.headingName.length;e++)a.status.sortState[e]=1}).then(function(){a.update()}):console.log("Network response was not ok.")}).catch(function(t){console.log("error:"+t)})},sortDocumentList:function(t){t.preventUpdate=!0,t.preventDefault();var e=t.target.id.split("_"),s=a.sortData(e[1],a.status.headingName,a.status.sortIcon,a.status.sortState,a.status._data);a.status.sortIcon=s[0],a.status.sortState=s[1],a.status.setData(s[2]),a.update()},viewAdminDocument:function(t){t.preventUpdate=!0,t.preventDefault(),console.log(t.target.id);var a=t.target.id.split("_"),e="/game/file/document/"+a[2];location.href=e},pageNation:function(t){t.preventDefault(),console.log("e:",t);var e=t.path[1].id.split("_");console.log("pageNation:",e);var s=a.pageJump(e[2],a.status.pageNumber,a.status.pageMax);a.status.pageNumber=s[0],a.status.pageLabel=s[1],a.update()},saveDocument:function(t){t.preventUpdate=!0,t.preventDefault();var e=new FormData(t.target),s={method:"POST",credentials:"include",body:e};console.log("e::",t),fetch("/game/file/document",s).then(function(t){return t.json()}).then(function(t){console.log("json:",t),location.href="/game/file/document?id="+a.status.publicYmlFileId}).catch(function(t){console.log("Save Error:",t)})},searchKey:function(){a.refs.search_key.value}},this.on("mount",a._func.init)}),riot.tag2("debug-login-signup-pregisted",'<a href="{api}">{opts.user}</a>',"","",function(t){this.api="/signup/regist?hash="+t.user}),riot.tag2("document-list",'<div class="container"> <div class="row"> <div class="col-xs-12"> <form> <input type="text" placeholder="検索ワードを入力" ref="search_key"> </form> </div> <div class="col-xs-12"> <table class="table table-hover"> <thead> <tr> <th onclick="{_func.sortDocumentList}" id="sort_origText" ref="origText" class="list-pointer"> 原文 <span class="{status.sortIcon[0]}" aria-hidden="true" aria-label="Right Align"></span> </th> <th onclick="{_func.sortDocumentList}" id="sort_transText" ref="transText" class="list-pointer"> 翻訳文(確定) <span class="{status.sortIcon[1]}" aria-hidden="true" aria-label="Right Align"></span> </th> <th onclick="{_func.sortDocumentList}" id="sort_remarks" ref="remarks" class="list-pointer"> 備考 <span class="{status.sortIcon[2]}" aria-hidden="true" aria-label="Right Align"></span> </th> <th ref="edit_delete"></th> </tr> </thead> <tbody> <tr each="{item, i in status.getData()}" name="{item.publicId}" if="{status.pageLabelCheck(status.pageIdLabel[i].label)}" class="list-pointer"> <th onclick="{modal.modalOn}" id="view_origText_{item.publicId}" class="popup-modal"> {item.origText} </th> <th onclick="{modal.modalOn}" id="view_transText_{item.publicId}" class="popup-modal"> {item.transText} </th> <th onclick="{modal.modalOn}" id="view_remarks_{item.publicId}" class="popup-modal"> {item.remarks} </th> </tr> </tbody> </table> </div> <div class="col-xs-12"> <ul class="pagination"> <li id="page_li_previous" onclick="{_func.pageNation}"> <a href="#" aria-label="Previous" id="page_a_previous"> <span aria-hidden="true" id="page_span_previous"> &laquo; </span> </a> </li> <li each="{page,i in status.getPage()}" id="page_li_{page.label}" class="{page.pageClass} " onclick="{_func.pageNation}"> <a href="#" id="page_a_{page.label}"> <span aria-hidden="true" id="page_span_{page.label}"> {page.label} </span> </a> </li> <li id="page_li_next" class="pageL1" onclick="{_func.pageNation}"> <a href="#" aria-label="Next" id="page_a_next"> <span aria-hidden="true" id="page_span_next"> &raquo; </span> </a> </li> </ul> </div> </div> </div> <div class="white-popup-block mfp-hide" id="document-popup-modal"> <div class="row"> <p class="col-xs-12">「閉じる」か「背景」をクリックするとモーダルウィンドウを終了します。</p> <form> <div class="form-group col-xs-12"> <label>Key:</label> <input required type="text" class="form-control" riot-value="{modal._document.key}" name="key"> </div> <div class="col-xs-6"> <div> 原文 </div> <textarea name="origText" row="12" class="form-control orig-text"> {modal._document.origText} </textarea> </div> <div class="col-xs-6"> <div class="col-xs-12"> <div> Google翻訳文 </div> <textarea name="transGoogleText" row="6" class="form-control"> {modal._document.transGoogleText} </textarea> </div> <div class="col-xs-12"> <div> 翻訳文 </div> <textarea name="transText" row="6" class="form-control"> {modal._document.transText} </textarea> </div> </div> <div class="col-xs-12"> <label>備考欄:</label> <input required type="text" class="form-control" riot-value="{modal._document.remarks}" name="remarks"> </div> <div></div> <button class="btn btn-primary">保存</button> <button class="btn btn-warning" onclick="{modal.modalOff}">キャンセル</button> </form> </div> </div>','document-list .list-pointer,[data-is="document-list"] .list-pointer{ cursor: pointer; } document-list .orig-text,[data-is="document-list"] .orig-text{ height:100%; }',"",function(t){$(document).ready(function(){$(".popup-modal").magnificPopup({items:{src:"#document-popup-modal"},type:"inline",preloader:!1,focus:"#name",callbacks:{beforeOpen:function(){$(window).width()<700?this.st.focus=!1:this.st.focus="#name"}}})});var a=this;this.mixin(OptsMixin),this.status={_data:[],headingName:[],sortState:[],sortIcon:[],edit:!1,newCreate:!1,publicYmlFileId:null,publicDocumentId:null,editName:null,editVersion:null,pageCount:5,pageMaxNation:5,pageMax:null,pageNumber:1,pageLabel:[],pageIdLabel:[],getData:function(){return a.status._data},setData:function(t){a.status._data=t,a.status.pageMax=Math.ceil(t.length/a.status.pageCount)},editOn:function(t){t.preventUpdate=!0,t.preventDefault(),a.status.edit=!0;t.target.id.split("_");location.href="/game/file/document?id="+a.status.publicYmlFileId+"#document-popup-model"},editOff:function(){a.status.edit=!1},newCreateOn:function(){a.status.newCreate=!0},newCreateOff:function(){a.status.newCreate=!1},setIdName:function(t,e){a.status.publicYmlFileId=t,a.status.editName=e},pageFileCheck:function(){a.status.pageLabel=a.pageCheck(a.status.pageMax,a.status.pageNumber),console.log(a.status.pageLabel)},getPage:function(){return a.status.pageLabel},setPageIdLabel:function(){for(var t=0;t<a.status._data.length;t++)a.status.pageIdLabel[t]={label:Math.ceil((t+1)/a.status.pageCount),id:a.status._data[t].publicId};a.status.pageMax=Math.ceil(a.status._data.length/a.status.pageCount),console.log("setPage:",a.status.pageIdLabel)},pageLabelCheck:function(t){if(t==a.status.pageNumber)return!0}},this.modal={_document:null,modalOn:function(t){t.preventUpdate=!0,t.preventDefault();for(var e=t.target.id.split("_"),s=0;s<a.status._data.length;s++)e[2]===a.status._data[s].publicId&&(a.modal._document=a.status._data[s]);a.update()},modalOff:function(t){t.preventUpdate=!0,t.preventDefault(),$.magnificPopup.close()}},this._func={init:function(){a.status.publicYmlFileId=t.publicId;var e="/document/"+a.status.publicYmlFileId,s={method:"GET",credentials:"include"};a.status.headingName[0]="origText",a.status.headingName[1]="transText",a.status.headingName[2]="remarks",a.status.pageNumber=1;for(var n=0;n<a.status.headingName.length;n++)a.status.sortIcon[n]="glyphicon glyphicon-sort";console.log(a.status.sortIcon),fetch(e,s).then(function(t){console.log("response:",t),t.ok?t.json().then(function(t){console.log("JSON:",t),a.status.setData(t.data),console.log("setData:",a.status),a.status.pageFileCheck(),a.status.setPageIdLabel(),a.status.pageLabel[a.status.pageNumber-1].pageClass="active";for(var e=0;e<a.status.headingName.length;e++)a.status.sortState[e]=1}).then(function(){a.update()}):console.log("Network response was not ok.")}).catch(function(t){console.log("error:"+t)})},sortDocumentList:function(t){t.preventUpdate=!0,t.preventDefault();var e=t.target.id.split("_"),s=a.sortData(e[1],a.status.headingName,a.status.sortIcon,a.status.sortState,a.status._data);a.status.sortIcon=s[0],a.status.sortState=s[1],a.status.setData(s[2]),a.update()},viewAdminDocument:function(t){t.preventUpdate=!0,t.preventDefault(),console.log(t.target.id);var a=t.target.id.split("_"),e="/game/file/document/"+a[2];location.href=e},pageNation:function(t){t.preventDefault(),console.log("e:",t);var e=t.path[1].id.split("_");console.log("pageNation:",e);var s=a.pageJump(e[2],a.status.pageNumber,a.status.pageMax);a.status.pageNumber=s[0],a.status.pageLabel=s[1],a.update()},searchKey:function(){a.refs.search_key.value}},this.on("mount",a._func.init)}),riot.tag2("footer-list",'<footer class="footer"> <div class="container"> <p class="text-muted">GAME TRANSLATION</p> </div> </footer>','footer-list html,[data-is="footer-list"] html{ position: relative; min-height: 100%; } footer-list body,[data-is="footer-list"] body{ padding-top: 70px; margin-bottom: 60px; } footer-list .footer,[data-is="footer-list"] .footer{ position: absolute; bottom: 0; width: 100%; height: 60px; background-color: #f5f5f5; } footer-list .container,[data-is="footer-list"] .container{ width: auto; max-width: 680px; padding: 0 15px; } footer-list .container .text-muted,[data-is="footer-list"] .container .text-muted{ margin: 20px 0; }',"",function(t){}),riot.tag2("header-game",'<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"> <a class="navbar-brand" href="#">Game Translation</a> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <div class="collapse navbar-collapse" id="navbarCollapse"> </div> </nav>',"","",function(t){var a=this;this.status={navtype:t.navtype,navCheck:function(t){return t===a.status.navtype}}}),riot.tag2("header-nav",'<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark"> <a class="navbar-brand" href="#">Game Translation</a> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation"> <span class="navbar-toggler-icon"></span> </button> <div class="collapse navbar-collapse" id="navbarCollapse"> <ul class="navbar-nav mr-auto"> <li class="nav-item {active:status.navCheck(\'game\')}"> <a class="nav-link" href="/game">Game <span if="{status.navCheck(game)}" class="sr-only">(current)</span> </a> </li> <li class="nav-item {active:status.navCheck(\'mypage\')}"> <a class="nav-link" href="#">MyPage <span if="{status.navCheck(mypage)}" class="sr-only">(current)</span> </a> </li> <li class="nav-item {active:status.navCheck(\'contact\')}"> <a class="nav-link" href="#">Contact <span if="{status.navCheck(contact)}" class="sr-only">(current)</span> </a> </li> </ul> <span class="navbar-text"> ようこそ{status.userData.userName}様 </span> &nbsp;&nbsp; <button class="btn btn-outline-success my-2 my-sm-0 list-pointer" onclick="{_func.logout}"> Logout </button> </div> </nav>',"","",function(t){var a=this;this.status={userData:null,navCheck:function(a){return a===t.navtype}},this._func={init:function(){var t={method:"GET",credentials:"include"};fetch("/user/account",t).then(function(t){console.log("response:",t),t.ok?t.json().then(function(t){a.status.userData=t.data}).then(function(){a.update()}):console.log("Network response was not ok.")}).catch(function(t){console.log("error:"+t)})},logout:function(){location.href="/logout"}},this.on("mount",a._func.init())}),riot.tag2("login-sign-up",'<div class="container"> <div class="row"> <div class="col-md-2"></div> <div class="card card-container col-md-8"> <br> <form class="form-signin" onsubmit="{_func.signUp}"> <div class="form-group row"> <label class="col-md-3 col-form-label">ユーザー名</label> <div class="col-md-9"> <input type="text" class="form-control" name="userName" ref="userName" placeholder="Name" required> </div> </div> <div class="form-group row"> <label class="col-md-3 col-form-label">Email</label> <div class="col-md-9"> <input class="form-control" name="mail" ref="mail" placeholder="Email" required type="email"> </div> </div> <div class="form-group row"> <label class="col-md-3 col-form-label">パスワード</label> <div class="col-md-9"> <input type="password" class="form-control" name="pass" ref="pass" placeholder="8桁のパスワード" required> </div> </div> <div class="form-group row"> <label class="col-md-3 col-form-label">パスワード(確認)</label> <div class="col-md-9"> <input type="password" class="form-control" name="rePass" ref="rePass" placeholder="パスワード(確認)" required> </div> </div> <div class="form-group row"> <label class="col-3 col-form-label">生年月日</label> <div class="col-9"> <input class="form-control" name="birthday" ref="birthday" required type="date"> </div> </div> <div class="form-group row"> <label class="col-3 col-form-label">電話番号</label> <div class="col-9"> <input type="tel" class="form-control" name="mobileNumber" ref="mobileNumber" value="00000000"> </div> </div> <div class="row"> <div class="col-md-9 offset-md-3"> <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#confirmationModal" onclick="{_func.confirm}">&nbsp&nbsp確認&nbsp&nbsp </button> <button type="button" class="btn btn-primary" onclick="{_func.cancel}">キャンセル</button> </div> </div> <div class="modal fade" id="confirmationModal" tabindex="-1" role="dialog" aria-labelledby="confirmationModalLabel" aria-hidden="true"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header"> <h5 class="modal-title" id="confirmationModalLabel">確認フォーム</h5> <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> </div> <div class="modal-body"> <table class="table"> <tbody> <tr> <td>ユーザー名</td> <td>{refs.userName.value}</td> </tr> <tr> <td>Email</td> <td>{refs.mail.value}</td> </tr> <tr> <td>パスワード</td> <td>{refs.pass.value}</td> </tr> <tr> <td>生年月日</td> <td>{refs.birthday.value}</td> </tr> <tr> <td>電話番号</td> <td>{refs.mobileNumber.value}</td> </tr> </tbody> </table> </div> <div class="modal-footer"> <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button> <button type="submit" class="btn btn-primary">Save changes</button> </div> </div> </div> </div> </form> <br> </div> <div class="col-md-2"></div> </div> </div>',"","",function(t){this._func={confirm:function(t){},signUp:function(t){t.preventUpdate=!0,t.preventDefault(),console.log("e:",t);var a=new FormData(t.target),e={method:"POST",credentials:"include",body:a};console.log("e.form:",a),fetch("/signup",e).then(function(t){return t.json()}).then(function(t){console.log("json:",t),200==t.code&&(location.href="/debug/signup/preregisted?hash="+t.message)}).catch(function(t){console.log("Save Error:",t)})},cancel:function(){location.href="/login"}}}),riot.tag2("login-top",'<div class="container"> <div class="row"> <div class="col-md-3"></div> <div class="card card-container col-md-6"> <h1>ログイン</h1> <form class="form-signin" onsubmit="{_func.login}"> <div class="form-group"> <input id="inputEmail" name="mail" class="form-control" placeholder="Email address" required autofocus type="email"> </div> <div class="form-group"> <input type="password" id="inputPassword" name="pass" class="form-control" placeholder="Password" required> </div> <button class="btn btn-lg btn-primary btn-block btn-signin list-pointer" type="submit">ログイン</button> </form> <br> <a href="#" class="forgot-password"> Forgot the password? </a> <hr> <div> <form onsubmit="{_func.login}"> <input type="hidden" name="mail" value="kakoseiya@gmail.com"> <input type="hidden" name="pass" value="guest04140414"> <button class="btn btn-primary list-pointer" type="submit"> ゲストでログインする </button> <button class="btn btn-primary list-pointer" type="button" onclick="{_func.createUser}"> 新規作成 </button> </form> </div> <br> </div> <div class="col-md-3"></div> </div> </div>',"","",function(t){this._func={createUser:function(){location.href="/signup"},login:function(t){t.preventUpdate=!0,t.preventDefault(),console.log("e:",t);var a=new FormData(t.target),e={method:"POST",credentials:"include",body:a};console.log("e.form:",a),fetch("/login",e).then(function(t){return t.json()}).then(function(t){console.log("json:",t),200===t.code&&(location.href=t.message)}).catch(function(t){console.log("Save Error:",t)})}}}),riot.tag2("translation-document",'<div> <div class="row"> <div class="col-md-12"> <div class="row"> <div class="col-md-6"> <button class="btn btn-primary list-pointer" data-toggle="modal" data-target="#document_admin_Modal" onclick="{modal.modalOnCreate}"> <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 新規作成 </button> </div> <div class="col-md-6"> <form> <input type="text" placeholder="検索ワードを入力" ref="search_key"> </form> </div> </div> <br> </div> <table class="table table-hover col-md-12"> <thead> <tr class="row"> <th onclick="{_func.sortDocumentList}" id="sort_origText" ref="origText" class="list-pointer col-md-6"> 原文 <span class="{status.sortIcon[0]}" aria-hidden="true" aria-label="Right Align"></span> </th> <th onclick="{_func.sortDocumentList}" id="sort_transText" ref="transText" class="list-pointer col-md-3"> 翻訳文 <span class="{status.sortIcon[1]}" aria-hidden="true" aria-label="Right Align"></span> </th> <th onclick="{_func.sortDocumentList}" id="sort_remarks" ref="remarks" class="list-pointer col-md-3"> 備考 <span class="{status.sortIcon[2]}" aria-hidden="true" aria-label="Right Align"></span> </th> </tr> </thead> <tbody> <tr each="{item, i in status.getData()}" name="{item.publicId}" class="list-pointer row"> <th onclick="{modal.modalOn}" class="col-md-6" id="view_origText_{item.publicId}" data-toggle="modal" data-target="#document_admin_Modal"> {item.origText} </th> <th onclick="{modal.modalOn}" class="col-md-3" id="view_transText_{item.publicId}" data-toggle="modal" data-target="#document_admin_Modal"> {item.transText} </th> <th onclick="{modal.modalOn}" class="col-md-3" id="view_remarks_{item.publicId}" data-toggle="modal" data-target="#document_admin_Modal"> {item.remarks} </th> </tr> </tbody> </table> </div> <div class="modal fade" id="document_admin_Modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLongTitle" aria-hidden="true"> <div class="modal-dialog modal-lg" role="document"> <div class="modal-content"> <div class="modal-header"> <h5 class="modal-title" id="exampleModalLongTitle">Modal title</h5> <button type="button" class="close list-pointer" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> </div> <div class="modal-body"> <form onsubmit="{_func.saveDocument}"> <input if="{!status.newFlag}" type="hidden" name="publicId" riot-value="{modal._document.publicId}"> <input type="hidden" name="ymlFileId" riot-value="{opts.publicid}"> <div class="row"> <div class="form-group col-md-12"> <label>Key:</label> <input required type="text" class="form-control" riot-value="{modal._document.key}" name="key"> </div> </div> <div class="row"> <div class="form-group col-md-6"> <div>原文</div> <textarea name="origText" rows="14" class="form-control">{modal._document.origText}</textarea> </div> <div class="col-md-6"> <div class="form-group col-md-12"> <div>Google翻訳</div> <textarea name="transGoogleText" rows="6" class="form-control">{modal._document.transGoogleText}</textarea> </div> <div class="form-group col-md-12"> <div>翻訳</div> <textarea name="transText" rows="6" class="form-control">{modal._document.transText}</textarea> </div> </div> </div> <div class="row"> <div class="form-group col-md-12"> <label>備考欄:</label> <input required type="text" class="form-control" riot-value="{modal._document.remarks}" name="remarks"> </div> </div> <div class="row"> <div class="form-group col-md-12"> <input type="radio" name="status" value="50" checked="{checked:modal.checkStatus()}">翻訳完了 <input type="radio" name="status" value="0" checked="{checked:!modal.checkStatus()}">未完了 </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-secondary list-pointer" data-dismiss="modal"> Close </button> <button type="submit" class="btn btn-primary list-pointer">Save changes</button> </div> </form> </div> </div> </div> </div> </div>','translation-document .list-pointer,[data-is="translation-document"] .list-pointer{ cursor: pointer; }',"",function(t){var a=this;this.mixin(OptsMixin),this.status={_data:[],headingName:[],sortState:[],sortIcon:[],edit:!1,newCreate:!1,publicYmlFileId:t.publicid,publicDocumentId:null,editName:null,editVersion:null,pageCount:5,pageMaxNation:5,pageMax:null,pageNumber:1,pageLabel:[],pageIdLabel:[],newFlag:!1,fileStatus:!1,getData:function(){return a.status._data},setData:function(t){a.status._data=t,a.status.pageMax=Math.ceil(t.length/a.status.pageCount)},editOn:function(t){t.preventUpdate=!0,t.preventDefault(),a.status.edit=!0;t.target.id.split("_");location.href="/game/file/document?id="+a.status.publicYmlFileId+"#document-popup-model"},editOff:function(){a.status.edit=!1},newCreateOn:function(){a.status.newCreate=!0},newCreateOff:function(){a.status.newCreate=!1},setIdName:function(t,e){a.status.publicYmlFileId=t,a.status.editName=e},pageFileCheck:function(){a.status.pageLabel=a.pageCheck(a.status.pageMax,a.status.pageNumber),console.log(a.status.pageLabel)},getPage:function(){return a.status.pageLabel},setPageIdLabel:function(){for(var t=0;t<a.status._data.length;t++)a.status.pageIdLabel[t]={label:Math.ceil((t+1)/a.status.pageCount),id:a.status._data[t].publicId};a.status.pageMax=Math.ceil(a.status._data.length/a.status.pageCount),console.log("setPage:",a.status.pageIdLabel)},pageLabelCheck:function(t){if(t==a.status.pageNumber)return!0}},this.modal={_document:null,modalOnCreate:function(){a.status.newFlag=!0,a.modal._document={key:"",origText:"",transGoogleText:"",transText:"",remarks:"",publicId:""},a.update()},modalOn:function(t){t.preventUpdate=!0,t.preventDefault(),a.status.newFlag=!1;for(var e=t.target.id.split("_"),s=0;s<a.status._data.length;s++)e[2]===a.status._data[s].publicId&&(a.modal._document=a.status._data[s]);console.log("modal_Document",a.modal._document),a.update()},modalOff:function(t){t.preventUpdate=!0,t.preventDefault()},checkStatus:function(){return 50==a.modal._document.status?(console.log(!0),!0):(console.log(!1),!1)}},this._func={init:function(){for(var t="/document/"+a.status.publicYmlFileId,e={method:"GET",credentials:"include"},s=0;s<a.status.headingName.length;s++)a.status.sortIcon[s]="glyphicon glyphicon-sort";console.log("api",t),fetch(t,e).then(function(t){console.log("response:",t),t.ok?t.json().then(function(t){console.log("JSON:",t),a.status.newFlag=!0,a.status.setData(t.data),console.log("setData:",a.status),a.status.pageFileCheck(),a.status.setPageIdLabel(),a.modal.modalOnCreate(),a.status.pageLabel[a.status.pageNumber-1].pageClass="active";for(var e=0;e<a.status.headingName.length;e++)a.status.sortState[e]=1}).then(function(){a.update()}):console.log("Network response was not ok.")}).catch(function(t){console.log("error:"+t)})},sortDocumentList:function(t){t.preventUpdate=!0,t.preventDefault();var e=t.target.id.split("_"),s=a.sortData(e[1],a.status.headingName,a.status.sortIcon,a.status.sortState,a.status._data);a.status.sortIcon=s[0],a.status.sortState=s[1],a.status.setData(s[2]),a.update()},viewAdminDocument:function(t){t.preventUpdate=!0,t.preventDefault(),console.log(t.target.id);var a=t.target.id.split("_"),e="/game/file/document/"+a[2];location.href=e},pageNation:function(t){t.preventDefault(),console.log("e:",t);var e=t.path[1].id.split("_");console.log("pageNation:",e);var s=a.pageJump(e[2],a.status.pageNumber,a.status.pageMax);a.status.pageNumber=s[0],a.status.pageLabel=s[1],a.update()},saveDocument:function(t){t.preventUpdate=!0,t.preventDefault();var e=new FormData(t.target),s={method:"POST",credentials:"include",body:e};console.log("e::",t),fetch("/game/file/document",s).then(function(t){return t.json()}).then(function(t){console.log("json:",t),location.href="/game/file/document?id="+a.status.publicYmlFileId}).catch(function(t){console.log("Save Error:",t)})},searchKey:function(){a.refs.search_key.value}},this.on("mount",a._func.init)}),riot.tag2("translation-game-document",'<div class="container"> <nav aria-label="パンくずリスト"> <ol class="breadcrumb mb-1"> <li class="breadcrumb-item"><a href="/game">Game</a></li> <li class="breadcrumb-item"><a href="/game/file?id={status.gamePublicId}">Ymlファイル</a></li> <li class="breadcrumb-item active" aria-current="page">ドキュメント</li> </ol> </nav> <br> <nav class="nav nav-tabs" id="myTab" role="tablist"> <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true"> List </a> <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false"> 概要 </a> <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="#nav-contact" role="tab" aria-controls="nav-contact" aria-selected="false"> Chat </a> </nav> <div class="tab-content" id="nav-tabContent"> <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab"> <br> <translation-document publicid="{opts.publicid}"></translation-document> </div> <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab"> dddddddddddd... </div> <div class="tab-pane fade" id="nav-contact" role="tabpanel" aria-labelledby="nav-contact-tab"> vvvvvvvvvsssssss... </div> </div> </div>',"","",function(t){var a=this;this.status={gamePublicId:null,ymlFilePublicId:t.publicid,fileTag:!1,documentTag:!1},this._func={init:function(){
a.status.fileTag=!0,a.status.documentTag=!1,console.log("ssss",a.status.ymlFilePublicId),console.log("ssss",t);var e="/file?id="+a.status.ymlFilePublicId,s={method:"GET",credentials:"include"};console.log("api",e),fetch(e,s).then(function(t){return t.json()}).then(function(t){console.log("json::",t),a.status.gamePublicId=t.data.game.publicId,console.log(a.status.gamePublicId),a.update()}).catch(function(t){console.log("error:",t)}),riot.mount("translation-document")}},this.on("mount",this._func.init())}),riot.tag2("translation-game-item",'<div class="card"> <div class="card-block"> <h4 class="card-title">{opts.name}</h4> <h6 class="card-subtitle mb-2 text-muted">Card subtitle</h6> <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card\'s content.</p> <a href="#" class="card-link">Card link</a> <a href="#" class="card-link">Another link</a> </div> </div>','translation-game-item .list-pointer,[data-is="translation-game-item"] .list-pointer{ cursor: pointer; }',"",function(t){}),riot.tag2("translation-game-list",'<div class="container"> <div class="row"> <div class="col-md-12"> <form> <input type="text" id="search_key" placeholder="検索ワードを入力" ref="search_key"> </form> </div> </div> <br> <div class="row"> <div class="col-md-12" each="{item,i in status._data}"> <div class="card"> <div class="card-body"> <h4 class="card-title list-pointer" onclick="{_func.viewFileList}" id="view_{item.publicId}"> {item.name} </h4> <h6 class="card-subtitle mb-2 text-muted">{item.version}</h6> <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card\'s content.</p> <a href="#" class="card-link">Card link</a> <a href="#" class="card-link">Another link</a> </div> </div> <br> </div> </div> </div>','translation-game-list .list-pointer,[data-is="translation-game-list"] .list-pointer{ cursor: pointer; }',"",function(t){var a=this;this.mixin(OptsMixin),this.status={_data:[],headingName:[],sortState:[],sortIcon:[],edit:!1,newCreate:!1,publicGameId:null,editName:null,editVersion:null,pageCount:5,pageMaxNation:5,pageMax:null,pageNumber:1,pageLabel:[],pageIdLabel:[],getData:function(){return a.status._data},setData:function(t){a.status._data=t,a.status.pageMax=Math.ceil(t.length/a.status.pageCount)},editOn:function(){a.status.edit=!0},editOff:function(){a.status.edit=!1},newCreateOn:function(){a.status.newCreate=!0},newCreateOff:function(){a.status.newCreate=!1},setIdNameVersion:function(t,e,s){a.status.publicGameId=t,a.status.editName=e,a.status.editVersion=s},pageGameCheck:function(){a.status.pageLabel=a.pageCheck(a.status.pageMax,a.status.pageNumber),console.log(a.status.pageLabel)},getPage:function(){return a.status.pageLabel},setPageIdLabel:function(){for(var t=0;t<a.status._data.length;t++)a.status.pageIdLabel[t]={label:Math.ceil((t+1)/a.status.pageCount),id:a.status._data[t].publicId};a.status.pageMax=Math.ceil(a.status._data.length/a.status.pageCount),console.log("setPage:",a.status.pageIdLabel)},pageLabelCheck:function(t){if(t==a.status.pageNumber)return!0}},this._func={init:function(){var t={method:"GET",credentials:"include"};a.status.headingName[0]="name",a.status.headingName[1]="version",a.status.pageNumber=1;for(var e=0;e<a.status.headingName.length;e++)a.status.sortIcon[e]="glyphicon glyphicon-sort";console.log("init:",a.status),fetch("/game/list",t).then(function(t){console.log("response:",t),t.ok?t.json().then(function(t){a.status.setData(t.data),console.log("setData:",a.status),a.status.pageGameCheck(),a.status.setPageIdLabel(),a.status.pageLabel[a.status.pageNumber-1].pageClass="active";for(var e=0;e<a.status.headingName.length;e++)a.status.sortState[e]=1}).then(function(){console.log(a.status.sortState),a.update()}):console.log("Network response was not ok.")}).catch(function(t){console.log("error:"+t)})},sortGameList:function(t){t.preventUpdate=!0,t.preventDefault();var e=t.target.id.split("_"),s=a.sortData(e[1],a.status.headingName,a.status.sortIcon,a.status.sortState,a.status._data);a.status.sortIcon=s[0],a.status.sortState=s[1],a.status.setData(s[2]),a.update()},viewFileList:function(t){t.preventUpdate=!0,t.preventDefault(),console.log(t.target.id);var a=t.target.id.split("_"),e="/game/file?id="+a[1];location.href=e},saveGame:function(t){t.preventUpdate=!0,t.preventDefault();var e=new FormData(t.target),s={method:"POST",credentials:"include",body:e};console.log("Error:",t),fetch("/game",s).then(function(t){return t.json()}).then(function(t){console.log("json:",t),a.status.newCreateOff(),a._func.init(),a.update()}).catch(function(t){console.log("Save Error:",t)})},deleteGame:function(t){t.preventUpdate=!0,t.preventDefault();var e=t.target.id,s="/game?id="+e[1],n={method:"DELETE",credentials:"include"};fetch(s,n).then(function(t){return t.json()}).then(function(t){console.log("削除成功:",t),a._func.init(),a.update()}).catch(function(t){console.log("error:"+t)})},adminGame:function(t){t.preventUpdate=!0,t.preventDefault();var e=new FormData(t.target),s={method:"POST",credentials:"include",body:e};console.log("Error:",t),fetch("/game",s).then(function(t){return t.json()}).then(function(t){console.log("json:",t),a.status.editOff(),a._func.init(),a.update()}).catch(function(t){console.log("Edit Save Error:",t)})},editGame:function(t){if(t.preventUpdate=!0,t.preventDefault(),a.status.edit)a.status.editOff(),a.update();else{a.status.newCreateOff(),console.log("editGame:",t);var e=t.target.id.split("_");a.status.setIdNameVersion(e[1],e[2],e[3]),a.status.editOn(),a.update()}},cancel:function(){a.status.edit=!1,a.newCreate=!1,a.status.publicGameId=null,a.status.editName=null,a.status.editVersion=null},pageNation:function(t){t.preventDefault(),console.log("e:",t);var e=t.path[1].id.split("_");console.log("pageNation:",e);var s=a.pageJump(e[2],a.status.pageNumber,a.status.pageMax);a.status.pageNumber=s[0],a.status.pageLabel=s[1],a.update()},searchKey:function(){a.refs.search_key.value}},this.on("mount",a._func.init),riot.mount("game-item")}),riot.tag2("translation-game-yml",'<div class="container"> <nav aria-label="パンくずリスト"> <ol class="breadcrumb mb-1"> <li class="breadcrumb-item"><a href="/game">Game</a></li> <li class="breadcrumb-item active" aria-current="page">Ymlファイル</li> </ol> </nav> <br> <nav class="nav nav-tabs" id="myTab" role="tablist"> <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-home" role="tab" aria-controls="nav-home" aria-selected="true"> List </a> <a class="nav-item nav-link" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="false"> 概要 </a> <a class="nav-item nav-link" id="nav-contact-tab" data-toggle="tab" href="#nav-contact" role="tab" aria-controls="nav-contact" aria-selected="false"> Chat </a> </nav> <div class="tab-content" id="nav-tabContent"> <div class="tab-pane fade show active" id="nav-home" role="tabpanel" aria-labelledby="nav-home-tab"> <br> <translation-yml-file publicid="{status.gamePublicId}"></translation-yml-file> </div> <div class="tab-pane fade" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab"> dddddddddddd... </div> <div class="tab-pane fade" id="nav-contact" role="tabpanel" aria-labelledby="nav-contact-tab"> vvvvvvvvvsssssss... </div> </div> </div>',"","",function(t){var a=this,e=null;this.status={gamePublicId:t.publicid,fileTag:!1,documentTag:!1},this._func={init:function(){a.status.fileTag=!0,a.status.documentTag=!1,e=riot.observable(),riot.mount("translation-yml-file")}},this.on("mount",this._func.init()),e.on("changeTag",function(t){console.log("changeTag:",t),a.status.documentTag=!0,a.status.fileTag=!1,e.trigger("viewDocument",t),a.update()})}),riot.tag2("translation-yml-file",'<div class="row"> <div class="col"> <form> <input type="text" placeholder="検索ワードを入力" ref="search_key"> </form> </div> <div class="col"> <button class="btn btn-primary" data-toggle="modal" data-target="#newCreateModal" onclick="{status.newCreateOn}"> <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 新規作成 </button> </div> <br> </div> <div class="row"> <div class="col-md-12" each="{item,i in status._data}"> <div class="card"> <div class="card-body"> <h4 class="card-title" id="card_view_{item.publicId}" onclick="{_func.viewDocumentList}"> {item.name}</h4> <p class="card-text"> {item.summary} </p> <div class="progress"> <div class="progress-bar" role="progressbar" riot-style="width: {item.rate}%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"> {item.rate}% </div> </div> <a href="#" class="card-link" data-toggle="modal" data-target="#editModal" onclick="{_func.editYmlFile}" id="card_{item.publicId}_{item.name}"> 編集 </a> <a href="#" class="card-link">削除</a> <a href="#" class="card-link" download="{item.name}" id="download_{item.publicId}" onclick="{_func.downloadYml}">ダウンロード</a> </div> </div> <br> </div> <div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="editModalLabel" aria-hidden="true"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header"> <h5 class="modal-title" id="editModalLabel">Modal title</h5> <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> </div> <form class="form-horizontal" onsubmit="{_func.adminYmlFile}"> <div class="modal-body"> <input type="hidden" name="publicId" riot-value="{status.publicGameId}"> <div class="form-group"> <label class="control-label col-md-3">File Name</label> <div class="col-md-9"> <input type="text" class="form-control" name="title" placeholder="{status.editName}"> </div> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="{_func.cancel}"> Close </button> <button type="submit" class="btn btn-primary">Save changes</button> </div> </form> </div> </div> </div> <div class="modal fade" id="newCreateModal" tabindex="-1" role="dialog" aria-labelledby="newCreateModalLabel" aria-hidden="true"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header"> <h5 class="modal-title" id="newCreateModalLabel">Modal title</h5> <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button> </div> <form onsubmit="{_func.saveYmlFile}"> <div class="modal-body"> <input type="hidden" name="gamePublicId" riot-value="{opts.publicid}"> <div class="form-group row"> <label class="control-label col-md-3">File Name</label> <input type="text" class="form-control col-md-8" name="fileName" placeholder="File Name"> </div> <div class="form-group row"> <label class="control-label col-md-3">備考欄</label> <textarea name="summary" rows="2" class="form-control col-md-8"></textarea> </div> <div class="form-group row"> <label class="control-label col-md-3">ファイル</label> <div class="col-md-8"> <input type="file" name="YmlFile" accept=".yml"> </div> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-secondary" data-dismiss="modal" onclick="{_func.cancel}"> Close </button> <button type="submit" class="btn btn-primary">Save changes</button> </div> </form> </div> </div> </div> </div>',"","",function(t){var a=this;this.mixin(OptsMixin),this.status={_data:[],headingName:[],sortState:[],sortIcon:[],edit:!1,newCreate:!1,publicGameId:null,publicYmlFileId:null,editName:null,editVersion:null,pageCount:5,pageMaxNation:5,pageMax:null,pageNumber:1,pageLabel:[],pageIdLabel:[],tagChange:!0,getData:function(){return a.status._data},setData:function(t){a.status._data=t,a.status.pageMax=Math.ceil(t.length/a.status.pageCount)},editOn:function(){a.status.edit=!0},editOff:function(){a.status.edit=!1},newCreateOn:function(){a.status.newCreate=!0},newCreateOff:function(){a.status.newCreate=!1},setIdName:function(t,e){a.status.publicYmlFileId=t,a.status.editName=e},pageFileCheck:function(){a.status.pageLabel=a.pageCheck(a.status.pageMax,a.status.pageNumber),console.log(a.status.pageLabel)},getPage:function(){return a.status.pageLabel},setPageIdLabel:function(){for(var t=0;t<a.status._data.length;t++)a.status.pageIdLabel[t]={label:Math.ceil((t+1)/a.status.pageCount),id:a.status._data[t].publicId};a.status.pageMax=Math.ceil(a.status._data.length/a.status.pageCount),console.log("setPage:",a.status.pageIdLabel)},pageLabelCheck:function(t){if(t==a.status.pageNumber)return!0}},this._func={init:function(){a.status.publicGameId=t.publicid,console.log("yyyyy",t.publicid);var e="/file/"+a.status.publicGameId,s={method:"GET",credentials:"include"};a.status.headingName[0]="name",a.status.headingName[1]="summary",a.status.headingName[2]="rate",a.status.pageNumber=1;for(var n=0;n<a.status.headingName.length;n++)a.status.sortIcon[n]="glyphicon glyphicon-sort";console.log(a.status.sortIcon),fetch(e,s).then(function(t){console.log("response:",t),t.ok?t.json().then(function(t){console.log("JSON:",t),a.status.setData(t.data),console.log("setData:",a.status),a.status.pageFileCheck(),a.status.setPageIdLabel(),a.status.pageLabel[a.status.pageNumber-1].pageClass="active";for(var e=0;e<a.status.headingName.length;e++)a.status.sortState[e]=1}).then(function(){a.update()}):console.log("Network response was not ok.")}).catch(function(t){console.log("error:"+t)})},sortYmlFileList:function(t){t.preventUpdate=!0,t.preventDefault();var e=t.target.id.split("_"),s=a.sortData(e[1],a.status.headingName,a.status.sortIcon,a.status.sortState,a.status._data);a.status.sortIcon=s[0],a.status.sortState=s[1],a.status.setData(s[2]),a.update()},viewDocumentList:function(t){t.preventUpdate=!0,t.preventDefault(),console.log(t.target.id);var e=t.target.id.split("_");console.log("obs:",a),a.status.tagChange=!1,a.update();var s="/game/file/document?id="+e[2];location.href=s},saveYmlFile:function(e){e.preventUpdate=!0,e.preventDefault();var s=new FormData(e.target),n="/game/ymlfile?id="+t.publicid,o={method:"POST",credentials:"include",body:s};fetch(n,o).then(function(t){return t.json()}).then(function(t){console.log("json:",t),a.status.newCreateOff(),a._func.init(),a.update()}).catch(function(t){console.log("Save Error:",t)})},deleteYmlFile:function(t){t.preventUpdate=!0,t.preventDefault();var e=t.target.id.split("_"),s="/game/file?id="+e[1],n={method:"DELETE",credentials:"include"};fetch(s,n).then(function(t){return t.json()}).then(function(t){console.log("削除成功:",t),a._func.init(),a.update()}).catch(function(t){console.log("error:"+t)})},adminYmlFile:function(t){t.preventUpdate=!0,t.preventDefault();var e=new FormData(t.target),s={method:"POST",credentials:"include",body:e};fetch("/game/file",s).then(function(t){return t.json()}).then(function(t){console.log("json:",t),a.status.editOff(),a._func.init(),a.update()}).catch(function(t){console.log("Edit Save Error:",t)})},editYmlFile:function(t){if(a.status.edit)a.status.editOff();else{t.preventUpdate=!0,t.preventDefault(),a.status.newCreateOff();var e=t.target.id.split("_"),s=e[2];console.log("es.length:",e);for(var n=3;n<e.length;n++)s=s+"_"+e[n],console.log(s);a.status.setIdName(e[1],s),a.status.editOn(),a.update()}},cancel:function(){a.status.edit=!1,a.newCreate=!1,a.status.publicYmlFileId=null,a.status.editName=null},pageNation:function(t){t.preventDefault(),console.log("e:",t);var e=t.path[1].id.split("_");console.log("pageNation:",e);var s=a.pageJump(e[2],a.status.pageNumber,a.status.pageMax);a.status.pageNumber=s[0],a.status.pageLabel=s[1],a.update()},downloadYml:function(t){t.preventUpdate=!0,t.preventDefault(),console.log("doyml:",t.target.id);var a=t.target.id.split("_"),e="",s="/file?id="+a[1],n={method:"GET",credentials:"include"};console.log("es",a),fetch(s,n).then(function(t){return t.json()}).then(function(t){console.log("JSON:",t),e="l_"+t.data.lang+":\r\n";for(var s=0;s<t.data.documents.length;s++)e+=" "+t.data.documents[s].key+' "'+t.data.documents[s].transText+'"\r\n';console.log("ymlText:\r\n",e);var n=new Uint8Array([e]);console.log("encYmlText:",n),console.log("document:",document),console.log(document.getElementById("download_"+a[1]));var o=new Uint8Array([239,187,191]),l=new Blob([o,e],{type:"application/x-msdownload"});console.log("Blob:",l),console.log("window",window);var i=document.createElement("a");if(i.setAttribute("download",t.data.name),i.href=URL.createObjectURL(l),window.navigator.msSaveBlob)window.navigator.msSaveOrOpenBlob(l,downloadFileName);else{var r=document.createEvent("MouseEvents");r.initEvent("click",!1,!0),i.dispatchEvent(r)}}).catch(function(t){console.log("error:",t)})},searchKey:function(){a.refs.search_key.value}},this.on("mount",a._func.init)}),riot.tag2("yml-file-list",'<div class="container"> <div class="row"> <div class="col-xs-12"> <form> <input type="text" placeholder="検索ワードを入力" ref="search_key"> </form> </div> <div class="col-xs-12"> <table class="table table-hover"> <thead> <tr> <th onclick="{_func.sortYmlFileList}" id="sort_name" ref="name" class="list-pointer"> File Name <span class="{status.sortIcon[0]}" aria-hidden="true" aria-label="Right Align"></span> </th> <th onclick="{_func.sortYmlFileList}" id="sort_summary" ref="summary" class="list-pointer"> 概要 <span class="{status.sortIcon[1]}" aria-hidden="true" aria-label="Right Align"></span> </th> <th onclick="{_func.sortYmlFileList}" id="sort_rate" ref="rate" class="list-pointer"> 翻訳率 [%] <span class="{status.sortIcon[2]}" aria-hidden="true" aria-label="Right Align"></span> </th> <th ref="edit_delete"></th> </tr> </thead> <tbody> <tr each="{item, i in status.getData()}" name="{item.publicId}" if="{status.pageLabelCheck(status.pageIdLabel[i].label)}" class="list-pointer"> <th onclick="{_func.viewDocumentList}" id="view_name_{item.publicId}">{item.name}</th> <th onclick="{_func.viewDocumentList}" id="view_summary_{item.publicId}">{item.summary}</th> <th onclick="{_func.viewDocumentList}" id="view_rate_{item.publicId}">{item.rate.toFixed(1)}</th> <th> <button class="btn btn-primary" id="admin_{item.publicId}_{item.name}_{item.version}" onclick="{_func.editYmlFile}"> <span class="glyphicon glyphicon-wrench" aria-hidden="true" aria-label="Right Align" id="adminspan_{item.publicId}_{item.name}_{item.version}"></span> 編集 </button> <button class="btn btn-primary" id="delete_{item.publicId}" onclick="{_func.deleteYmlFile}"> <span class="glyphicon glyphicon-trash" aria-hidden="true" aria-label="Right Align" id="deletespan_{item.publicId}"></span> 削除 </button> </th> </tr> </tbody> </table> </div> <div class="col-xs-12"> <ul class="pagination"> <li id="page_li_previous" onclick="{_func.pageNation}"> <a href="#" aria-label="Previous" id="page_a_previous"> <span aria-hidden="true" id="page_span_previous"> &laquo; </span> </a> </li> <li each="{page,i in status.getPage()}" id="page_li_{page.label}" class="{page.pageClass} " onclick="{_func.pageNation}"> <a href="#" id="page_a_{page.label}"> <span aria-hidden="true" id="page_span_{page.label}"> {page.label} </span> </a> </li> <li id="page_li_next" class="pageL1" onclick="{_func.pageNation}"> <a href="#" aria-label="Next" id="page_a_next"> <span aria-hidden="true" id="page_span_next"> &raquo; </span> </a> </li> </ul> </div> <div if="{!status.edit && !status.newCreate}" class="col-xs-6"> <button class="btn btn-primary" onclick="{status.newCreateOn}"> <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> 新規作成 </button> </div> <div if="{!status.edit && status.newCreate}" class="col-xs-12"> <form class="form-horizontal" onsubmit="{_func.saveYmlFile}"> <div class="form-group"> <label class="control-label col-xs-3">File Name</label> <div class="col-xs-9"> <input type="text" class="form-control" name="title" placeholder="File Name"> </div> <br> <label class="control-label col-xs-3">ファイルアップロード</label> <div class="col-xs-9"> <input type="file" name="file"> </div> </div> <div class="col-xs-9 col-xs-offset-3"> <button type="submit" class="btn btn-primary glyphicon glyphicon-save">新規保存</button> <button class="btn btn-primary glyphicon glyphicon-remove" onclick="{status.newCreateOff}"> キャンセル </button> </div> </form> </div> <div if="{status.edit && !status.newCreate}" class="col-xs-12"> <form class="form-horizontal" onsubmit="{_func.adminYmlFile}"> <input type="hidden" name="publicId" riot-value="{status.publicGameId}"> <div class="form-group"> <label class="control-label col-xs-3">File Name</label> <div class="col-xs-9"> <input type="text" class="form-control" name="title" placeholder="{status.editName}"> </div> </div> <div class="col-xs-9 col-xs-offset-3"> <button type="submit" class="btn btn-primary"> <span class="glyphicon glyphicon-save" aria-hidden="true"></span> 保存 </button> <button class="btn btn-primary" onclick="{_func.cancel}"> <span class="glyphicon glyphicon-remove" aria-hidden="true"></span> キャンセル </button> </div> </form> </div> </div> </div>','yml-file-list .list-pointer,[data-is="yml-file-list"] .list-pointer{ cursor: pointer; }',"",function(t){var a=this;this.mixin(OptsMixin),this.status={_data:[],headingName:[],sortState:[],sortIcon:[],edit:!1,newCreate:!1,publicGameId:null,publicYmlFileId:null,editName:null,editVersion:null,pageCount:5,pageMaxNation:5,pageMax:null,pageNumber:1,pageLabel:[],pageIdLabel:[],getData:function(){return a.status._data},setData:function(t){a.status._data=t,a.status.pageMax=Math.ceil(t.length/a.status.pageCount)},editOn:function(){a.status.edit=!0},editOff:function(){a.status.edit=!1},newCreateOn:function(){a.status.newCreate=!0},newCreateOff:function(){a.status.newCreate=!1},setIdName:function(t,e){a.status.publicYmlFileId=t,a.status.editName=e},pageFileCheck:function(){a.status.pageLabel=a.pageCheck(a.status.pageMax,a.status.pageNumber),console.log(a.status.pageLabel)},getPage:function(){return a.status.pageLabel},setPageIdLabel:function(){for(var t=0;t<a.status._data.length;t++)a.status.pageIdLabel[t]={label:Math.ceil((t+1)/a.status.pageCount),id:a.status._data[t].publicId};a.status.pageMax=Math.ceil(a.status._data.length/a.status.pageCount),console.log("setPage:",a.status.pageIdLabel)},pageLabelCheck:function(t){if(t==a.status.pageNumber)return!0}},this._func={init:function(){a.status.publicGameId=t.publicId;var e="/file/"+a.status.publicGameId,s={method:"GET",credentials:"include"};a.status.headingName[0]="name",a.status.headingName[1]="summary",a.status.headingName[2]="rate",a.status.pageNumber=1;for(var n=0;n<a.status.headingName.length;n++)a.status.sortIcon[n]="glyphicon glyphicon-sort";console.log(a.status.sortIcon),fetch(e,s).then(function(t){console.log("response:",t),t.ok?t.json().then(function(t){console.log("JSON:",t),a.status.setData(t.data),console.log("setData:",a.status),a.status.pageFileCheck(),a.status.setPageIdLabel(),a.status.pageLabel[a.status.pageNumber-1].pageClass="active";for(var e=0;e<a.status.headingName.length;e++)a.status.sortState[e]=1}).then(function(){a.update()}):console.log("Network response was not ok.")}).catch(function(t){console.log("error:"+t)})},sortYmlFileList:function(t){t.preventUpdate=!0,t.preventDefault();var e=t.target.id.split("_"),s=a.sortData(e[1],a.status.headingName,a.status.sortIcon,a.status.sortState,a.status._data);a.status.sortIcon=s[0],a.status.sortState=s[1],a.status.setData(s[2]),a.update()},viewDocumentList:function(t){t.preventUpdate=!0,t.preventDefault(),console.log(t.target.id);var a=t.target.id.split("_"),e="/game/file/document?id="+a[2];location.href=e},saveYmlFile:function(t){t.preventUpdate=!0,t.preventDefault();var e=new FormData(t.target),s={method:"POST",credentials:"include",body:e};fetch("/game/file",s).then(function(t){return t.json()}).then(function(t){console.log("json:",t),a.status.newCreateOff(),a._func.init(),a.update()}).catch(function(t){console.log("Save Error:",t)})},deleteYmlFile:function(t){t.preventUpdate=!0,t.preventDefault();var e=t.target.id.split("_"),s="/game/file?id="+e[1],n={method:"DELETE",credentials:"include"};fetch(s,n).then(function(t){return t.json()}).then(function(t){console.log("削除成功:",t),a._func.init(),a.update()}).catch(function(t){console.log("error:"+t)})},adminYmlFile:function(t){t.preventUpdate=!0,t.preventDefault();var e=new FormData(t.target),s={method:"POST",credentials:"include",body:e};fetch("/game/file",s).then(function(t){return t.json()}).then(function(t){console.log("json:",t),a.status.editOff(),a._func.init(),a.update()}).catch(function(t){console.log("Edit Save Error:",t)})},editYmlFile:function(t){if(a.status.edit)a.status.editOff();else{t.preventUpdate=!0,t.preventDefault(),a.status.newCreateOff();var e=t.target.id.split("_"),s=e[2];console.log("es.length:",e);for(var n=3;n<e.length-1;n++)s=s+"_"+e[n],console.log(s);a.status.setIdName(e[1],s),a.status.editOn(),a.update()}},cancel:function(){a.status.edit=!1,a.newCreate=!1,a.status.publicYmlFileId=null,a.status.editName=null},pageNation:function(t){t.preventDefault(),console.log("e:",t);var e=t.path[1].id.split("_");console.log("pageNation:",e);var s=a.pageJump(e[2],a.status.pageNumber,a.status.pageMax);a.status.pageNumber=s[0],a.status.pageLabel=s[1],a.update()},searchKey:function(){a.refs.search_key.value}},this.on("mount",a._func.init)});